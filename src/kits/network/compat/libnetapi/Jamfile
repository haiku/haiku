SubDir HAIKU_TOP src kits network compat libnetapi ;

SetSubDirSupportedPlatformsBeOSCompatible ;

UsePrivateHeaders net ;
UseHeaders [ FDirName $(HAIKU_TOP) headers legacy network ] : true ;

if $(TARGET_PLATFORM) != haiku {
	UseHeaders [ FDirName $(HAIKU_TOP) headers posix ] : true ;
		# We need the public network headers also when not compiling for Haiku.
		# Unfortunately we get more than we want, namely all POSIX headers.
	UseHeaders [ FStandardOSHeaders ] : true ;
		# Needed for <net/*.h> and maybe other stuff.
}

{
	if $(TARGET_PLATFORM) = r5 {
		defines = [ FDefines BUILDING_R5_LIBNET ] ;
		SubDirCcFlags $(defines) ;
		SubDirC++Flags $(defines) ;
		PLATFORM_LIBS = ;
	} else {
		PLATFORM_LIBS = libsocket.so libbind.so ;
	}
}

SharedLibrary libnetapi.so :
	NetEndpoint.cpp
	NetAddress.cpp 
	NetBuffer.cpp
	NetDebug.cpp
	: be libnet.so $(PLATFORM_LIBS)
;

# Installation -- in the test directory for the time being
HaikuInstallRelSymLink install-networking
	: [ FDirName $(HAIKU_TEST_DIR) kits net lib ]
	: libnetapi.so
	: installed-networking-test ;

Package haiku-networkingkit-cvs :
	libnetapi.so :
#	boot home config lib ;
	boot home Desktop haiku-networkingkit lib ;
